<OsfDialog
    @onOpen={{perform this.onOpen}}
    @onClose={{this.onClose}}
    as |dialog|
>
    <dialog.trigger
        ...attributes
    >
        {{yield dialog}}
    </dialog.trigger>
    <dialog.heading>
        {{t 'osf-components.resources-list.edit_resource.heading'}}
    </dialog.heading>
    <dialog.main>
        {{#unless this.shouldShowPreview}}
            <FormControls
                @changeset={{this.changeset}} 
                as |form|
            >
                <form.text
                    @isRequired={{true}}
                    @valuePath={{'pid'}}
                    @label={{t 'osf-components.resources-list.edit_resource.doi'}}
                />
                <form.select
                    @isRequired={{true}}
                    @valuePath={{'resourceType'}}
                    @label={{t 'osf-components.resources-list.edit_resource.output_type'}}
                    @options={{this.availableTypes}}
                    @searchEnabled={{false}}
                    @renderInPlace={{true}}
                    as |type|
                >
                    {{t (concat 'osf-components.resources-list.edit_resource.' type)}}
                </form.select>
                <form.textarea
                    @isRequired={{true}}
                    @valuePath={{'description'}}
                    @label={{t 'osf-components.resources-list.edit_resource.description'}}
                />
            </FormControls>
        {{/unless}}
        {{#if this.shouldShowPreview}}
            <p>
                {{t 'osf-components.resources-list.edit_resource.check_your_doi'}}
            </p>
            <ResourcesList::ResourceCard @resource={{this.resource}} @eidtable={{false}} />
        {{/if}}
    </dialog.main>
    <dialog.footer>
        {{#if this.shouldShowPreview}}
            <Button
                {{on 'click' this.goToEdit}}
            >
                {{t 'general.edit'}}
            </Button>
            <Button
                @type='create'
                {{on 'click' (queue
                    (perform this.finalize)
                    dialog.close
                    @reload
                )}}
            >
                {{t 'general.add'}}
            </Button>

        {{else}}
            <Button
                {{on 'click' dialog.close}}
            >
                {{t 'general.cancel'}}
            </Button>
            <Button
                @type={{'primary'}}
                {{on 'click' (perform this.goToPreview)}}
            >
                {{t 'osf-components.resources-list.edit_resource.preview'}}
            </Button>
        {{/if}}
    </dialog.footer>
</OsfDialog>