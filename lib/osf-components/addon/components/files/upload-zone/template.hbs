{{#let (unique-id 'dropzone-widget') as |dropzoneId|}}
    <DropzoneWidget
        @options={{this.dropzoneOptions}}
        @dropzone={{false}}
        @enable={{this.canEdit}}
        @id={{dropzoneId}}
        @clickable={{this.clickable}}
        @uploadprogress={{action this.uploadProgress}}
        @success={{perform this.success}}
        @error={{action this.error}}
        @buildUrl={{action this.buildUrl}}
        @addedfile={{action this.addedFile}}
        @dragenter={{action (mut this.dropping) true}}
        @dragover={{action (mut this.dropping) true}}
        @drop={{action (mut this.dropping) false}}
        @dragleave={{action (mut this.dropping) false}}
    >
        <ResponsiveDropdown
            @disabled={{not this.canEdit}}
            as |dropdownMenu|
        >
            <dropdownMenu.trigger
                local-class='actions-menu-trigger'
                aria-label={{t 'osf-components.files-widget.expand_files_menu'}}
            >
                <OsfButton
                    local-class='trigger-button'
                    aria-label={{t 'osf-components.files-widget.expand_files_menu'}}
                    @type='success'
                >
                    <FaIcon @icon='plus' @size=2 @fixedWidth={{true}} />
                </OsfButton>
            </dropdownMenu.trigger>
            <dropdownMenu.content>
                <div
                    role='menu'
                    local-class='actions-menu-content'
                    {{did-insert (action this.updateClickable)}}
                    {{will-destroy (action this.updateClickable)}}
                    {{on 'click' dropdownMenu.close}}
                >
                    <OsfButton
                        aria-label={{t 'osf-components.files-widget.upload_file'}}
                        local-class='menu-button'
                        @type='link'
                        @bubble={{true}}
                        @class='{{this.uploadButtonClass}}'
                        @disabled={{this.isUploading}}
                    >
                        <FaIcon @icon='upload' @fixedWidth={{true}} />
                        {{t 'osf-components.files-widget.upload_file'}}
                    </OsfButton>
                    <OsfButton
                        aria-label={{t 'osf-components.files-widget.create_folder'}}
                        local-class='menu-button'
                        onclick={{action this.openDialog}}
                        @type='link'
                    >
                        <FaIcon @icon='folder' @fixedWidth={{true}} />
                        {{t 'osf-components.files-widget.create_folder'}}
                    </OsfButton>
                </div>
            </dropdownMenu.content>
        </ResponsiveDropdown>

        <OsfDialog
            @isOpen={{this.isOpen}}
            @onClose={{action this.closeDialog}}
            as |dialog|
        >
            <dialog.heading>
                {{t 'osf-components.files-widget.create_folder'}}
            </dialog.heading>
            <dialog.main local-class='dialog-main'>
                <Input
                    @value={{this.newFolderName}}
                    @placeholder={{t 'osf-components.files-widget.folder_name_placeholder'}}
                    @class='form-control'
                />
            </dialog.main>
            <dialog.footer>
                <OsfButton
                    @type='default'
                    @onClick={{dialog.close}}
                >
                    {{t 'general.cancel'}}
                </OsfButton>
                <OsfButton
                    @type='primary'
                    @onClick={{perform this.createFolder dialog.close}}
                    @disabled={{this.createFolder.isRunning}}
                >
                    {{t 'osf-components.files-widget.create'}}
                </OsfButton>
            </dialog.footer>
        </OsfDialog>

        {{yield (hash
            uploading=this.uploading
            isUploading=this.isUploading
        )}}
    </DropzoneWidget>
{{/let}}