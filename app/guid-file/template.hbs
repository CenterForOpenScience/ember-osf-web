<OsfLayout
    @backgroundClass={{local-class 'ContentBackground'}}
    @clampWidth = {{false}}
    @desktopMetadataMode='drawer'
    @metadataGutterClosed={{this.rightClosed}}
    as |layout|
>
    <layout.heading>
        <div local-class='FileDetail-project-link'>
            <OsfLink
                data-test-project-link
                data-analytics-name='Linked project'
                local-class='FileDetail__registration-link'
                @route='registries.overview.index'
                @models={{array this.model.id}}
            >
                {{t 'file_detail.file_project_placeholder'}}
                {{this.file.parentFolder}}
            </OsfLink>
        </div>
        <div local-class='FileDetail_filename-buttons'>
            <h2 data-test-filename>
                {{this.model.name}}
            </h2>
            <div local-class='FileDetail_file-options-wrapper'>
                {{#unless this.isMobile}}
                    <Button
                        aria-label={{t 'file_detail.show_revisions'}}
                        aria-controls='revisionsPanel'
                        local-class={{if this.revisionsVisible 'selectedMode'}}
                        {{on 'click' this.toggleRevisions}}
                    >
                        <FaIcon local-class='FileDetail__mobile-navbar-icon' @icon='history' />
                    </Button>
                    <Button
                        aria-label={{t 'file_detail.show_tags'}}
                        aria-controls='tagsPanel'
                        local-class={{if this.tagsVisible 'selectedMode'}}
                        {{on 'click' this.toggleTags}}
                    >
                        <FaIcon local-class='FileDetail__mobile-navbar-icon' @icon='tags' />
                    </Button>
                {{/unless}}
                <FileActionsMenu @item={{this.model}} />
            </div>
        </div>
        {{#if this.isMobile}}
            <nav local-class='FileDetail__mobile-navbar'>
                <Button
                    @layout='fake-link'
                    aria-label={{t 'file_detail.show_file'}}
                    local-class={{if this.rightClosed 'selectedMode'}}
                    disabled={{this.rightClosed}}
                    {{on 'click' layout.toggleMetadata}}
                >
                    <FaIcon local-class='FileDetail__mobile-navbar-icon' @icon='file-alt' />
                </Button>
                <Button
                    @layout='fake-link'
                    aria-label={{t 'file_detail.show_revisions'}}
                    aria-controls='revisionsPanel'
                    local-class={{if this.revisionsVisible 'selectedMode'}}
                    {{on 'click' this.toggleRevisions}}
                >
                    <FaIcon local-class='FileDetail__mobile-navbar-icon' @icon='history' />
                </Button>
                <Button
                    @layout='fake-link'
                    aria-label={{t 'file_detail.show_tags'}}
                    aria-controls='tagsPanel'
                    local-class={{if this.tagsVisible 'selectedMode'}}
                    {{on 'click' this.toggleTags}}
                >
                    <FaIcon local-class='FileDetail__mobile-navbar-icon' @icon='tags' />
                </Button>
            </nav>
        {{/if}}
    </layout.heading>
    <layout.main>
        <div id='mainPanel' class='col-lg-12' local-class='FileDetail_main'>
            <div class='row'>
                <div data-test-file-renderer id='mfrIframeParent' local-class='FileDetail-file-render' class='col-lg-12'>
                    <FileRenderer @download={{this.model.links.download}} />
                </div>
            </div>
        </div>
    </layout.main>
    <layout.right>
        {{#if this.tagsOpen}}
            <div id='tagsPanel'>
                <h2>
                    {{t 'general.tags'}}
                </h2>
                <hr>
                <div local-class='container-fluid FileDetail_tags-container'>
                    <p>
                        <a href='#'>{{t 'general.science'}}</a>
                    </p>
                    <p>
                        <a href='#'>{{t 'general.engineering'}}</a>
                    </p>
                </div>
            </div>
        {{/if}}
        {{#if this.revisionsOpen}}
            <div id='revisionsPanel'>
                <div local-class='FileDetail_version-header'>
                    <h2>{{t 'general.revisions'}}</h2>
                </div>
                <hr>
                <table local-class='FileDetail_Version-table'>
                    <tbody>
                        <tr>
                            <td local-class='FileDetaiil_revisions-tableVersionNumber'>
                                {{t 'file_detail.version.version_number'}}
                            </td>
                            <td local-class='FileDetaiil_revisions-tableDateCreated'>
                                {{t 'file_detail.version.date_created'}}
                            </td>
                            <td>
                                <ResponsiveDropdown
                                    data-test-more-buttons
                                    data-analytics-scope='Files'
                                    as |dd|
                                >
                                    <dd.trigger
                                        data-test-detail-trigger
                                        data-analytics-name='Toggle more button options'
                                        local-class='FileDetail_dropdown-trigger'
                                    >
                                        <Button
                                            data-analytics-name='File detail trigger'
                                            data-test-detail-trigger-button
                                            local-class='FileDetail_dropdown-trigger-button'
                                            @layout='fake-link'
                                        >
                                            <FaIcon @icon='caret-down' @fixedWidth={{true}} />
                                        </Button>
                                    </dd.trigger>
                                    <dd.content
                                        data-test-detail-content
                                        data-analytics-name='File detail dropdown'
                                        local-class='FileDetail_dropdown-content'
                                    >
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>
                                                        {{t 'file_detail.version.user'}} {{this.model.file.user}}
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <BsButton
                                                            data-test-copy-md5
                                                            data-analytics-name='Copy md5 button'
                                                            @bubble={{true}}
                                                            @onClick={{this.copy}}
                                                        >
                                                            <span>
                                                                <FaIcon @icon='copy' @fixedWidth={{true}} />
                                                                {{t 'file_detail.version.copy_md5'}}
                                                            </span>
                                                        </BsButton>
                                                    </td>
                                                    <td>
                                                        <i class='fa fa-info-circle'></i>
                                                        <span>
                                                            {{fa-icon 'info-circle'}}
                                                            <BsTooltip>
                                                                {{t 'file_detail.md5_description'}}
                                                            </BsTooltip>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <BsButton
                                                            data-test-copy-sha2
                                                            data-analytics-name='Copy sha-2 button'
                                                            @bubble={{true}}
                                                            @onClick={{this.copy}}
                                                        >
                                                            <span>
                                                                <FaIcon @icon='copy' @fixedWidth={{true}} />
                                                                {{t 'file_detail.version.copy_sha2'}}
                                                            </span>
                                                        </BsButton>
                                                    </td>
                                                    <td>
                                                        <i class='fa fa-info-circle'></i>
                                                        <span>
                                                            {{fa-icon 'info-circle'}}
                                                            <BsTooltip>
                                                                {{t 'file_detail.sha2_description'}}
                                                            </BsTooltip>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <BsButton
                                                            data-test-download-button
                                                            data-analytics-name='Download button'
                                                            @bubble={{true}}
                                                            @onClick={{this.download}}
                                                        >
                                                            <span>
                                                                <FaIcon @icon='download' @fixedWidth={{true}} />
                                                            </span>
                                                            {{t 'general.download'}}
                                                        </BsButton>
                                                    </td>
                                                    <td>
                                                        <div class='col-lg-1'>
                                                            {{t 'file_detail.version.download_count'}}
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </dd.content>
                                </ResponsiveDropdown>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <hr>
            </div>
        {{/if}}
    </layout.right>
</OsfLayout>
