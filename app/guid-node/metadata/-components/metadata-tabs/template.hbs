<div local-class='metadata-tab-container {{if this.isMobile 'mobile'}}'>
    <AriaTabs
        data-analytics-scope='Metadata Tab'
        @defaultIndex={{0}}
        @onSelect={{action this.changeTab}}
        local-class='tabs
            {{if this.showTabs 'hidden'}}
        '
        as |tab|
    >
        <tab.tabList
            local-class='tab-list {{if this.showMore 'showMore'}}'
            id='tab-list'
            as |tablist|

            {{did-insert this.didRenderList}}
        >
            <tablist.tab>{{t 'metadata.main-tab'}}</tablist.tab>
            {{#each this.records as |record| }}
                <tablist.tab>{{record.template.schemaName}}</tablist.tab>
            {{/each}}
        </tab.tabList>
        <tab.tabPanel>
            <div local-class='metadata-pane' data-test-registrations-pane>
                <NodeMetadataManager @node={{this.guidNode}} as |manager|>
                    {{#if manager.isGatheringData}}
                        <LoadingIndicator @dark={{true}} />
                    {{else}}
                        <NodeMetadataForm @manager={{manager}} />
                    {{/if}}
                </NodeMetadataManager>
            </div>
        </tab.tabPanel>
        {{#each this.records as |record| }}
            <tab.tabPanel>
                <CedarMetadataRenderer
                    @instanceObject={{record.metadata}}
                    @templateObject={{record.template.template}}
                />
            </tab.tabPanel>
        {{/each}}
    </AriaTabs>
    {{#if this.showTabs}}
        <div local-class='more-options'>
            {{#if this.showMore}}
                <FaIcon @icon='minus' 
                    data-test-show-less
                    aria-label={{t 'metadata.see-less'}}
                    {{on 'click' (action this.clickIcon)}}
                />
                <EmberTooltip
                    @side='right'
                >
                    {{t 'metadata.see-less'}}
                </EmberTooltip>
            {{else}}
                <FaIcon @icon='plus' 
                    data-test-show-more
                    aria-label={{t 'metadata.see-more'}}
                    {{on 'click' (action this.clickIcon)}}
                />
                <EmberTooltip
                    @side='right'
                >
                    {{t 'metadata.see-more'}}
                </EmberTooltip>
            {{/if}}
        </div>
    {{/if}}
</div>
